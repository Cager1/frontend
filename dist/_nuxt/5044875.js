(window.webpackJsonp=window.webpackJsonp||[]).push([[24,13],{495:function(e,t,n){"use strict";n.r(t);var r=n(30),o=(n(113),n(11),n(5),n(44),n(38),n(29),n(114),n(92));Object(o.d)("eager");var c={name:"my-jobs-menu",components:{ValidationObserver:o.a,ValidationProvider:o.b},data:function(){return{itemsPerPageArray:[4,8,12],search:"",filter:{},sortDesc:!1,page:1,itemsPerPage:8,sortBy:"name",keys:["Datum"],items:[],editedIndex:-1,editedName:"",editedItem:{name:"",description:"",selection:[37]},defaultItem:{name:"",description:"",user:""},services:[],snackbar:!1,timeout:2e3,message:"",color:"",dialog:!1,dialogDelete:!1}},computed:{numberOfPages:function(){return Math.ceil(this.items.length/this.itemsPerPage)},filteredKeys:function(){return this.keys.filter((function(e){return"Name"!==e}))},formTitle:function(){return-1===this.editedIndex?"Dodaj posao":"Uredi posao"}},watch:{dialog:function(e){e||this.close()},dialogDelete:function(e){e||this.closeDelete()}},mounted:function(){this.getJobs(),this.getServices()},methods:{getServices:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.$get("/services",e.config).then((function(t){e.services=t,console.log("Servisi: "),console.log(e.services)})).catch((function(e){console.log(e)}));case 2:case"end":return t.stop()}}),t)})))()},getJobs:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,o,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.items=[],t.next=3,e.$axios.$get("/user/"+e.$auth.$state.user.id).then((function(e){n=e.jobs}));case 3:r=e.$auth.$state.user,console.log("Jobs: "),console.log(n),o=regeneratorRuntime.mark((function t(i){var o,c,l,time,d,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n[i].id,c=void 0,t.next=4,e.$axios.$get("/job/"+o).then((function(e){c=e.services,console.log(c)})).catch((function(e){console.log(e)}));case 4:for(n[i].datum=n[i].created_at,l=new Date(n[i].datum),time=new Date(n[i].datum),n[i].datum=l.toLocaleDateString("hr-HR")+" "+time.toLocaleTimeString("hr-HR"),d=[],v=0;v<c.length;v++)d.push(c[v].name);console.log("Services",d),n[i].services_names=d,n[i].user=r,e.items.push(n[i]);case 14:case"end":return t.stop()}}),t)})),i=0;case 8:if(!(i<n.length)){t.next=13;break}return t.delegateYield(o(i),"t0",10);case 10:i++,t.next=8;break;case 13:case"end":return t.stop()}}),t)})))()},close:function(){var e=this;this.dialog=!1,this.$nextTick((function(){e.editedItem=Object.assign({},e.defaultItem),e.editedIndex=-1}))},deleteItem:function(){this.dialogDelete=!0},closeDelete:function(){this.dialogDelete=!1},deleteJob:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={headers:{Authorization:t.$auth.strategy.token.get()}},console.log(e),n.next=4,t.$axios.$delete("/job/"+e.id,r).then((function(e){t.message=e.message,t.color="success",t.snackbar=!0,t.getJobs(),t.closeDelete()})).catch((function(e){console.log(e.response),t.message=e.response.message,t.color="error",t.snackbar=!0,t.closeDelete()}));case 4:case"end":return n.stop()}}),n)})))()},editItem:function(e){this.editedIndex=this.items.indexOf(e),this.editedName=e.name,this.editedItem=Object.assign({},e),this.dialog=!0},update:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={headers:{Authorization:e.$auth.strategy.token.get()}},t.next=3,e.$axios.$put("/admin/job/4",e.editedItem,n).then((function(t){console.log("Posa update: "),console.log(t),e.editedIndex>-1?Object.assign(e.items[e.editedIndex],e.editedItem):e.items.push(e.editedItem),e.message=t.message,e.color="success",e.snackbar=!0,e.getJobs()})).catch((function(t){console.log(t),e.message=t.message,e.color="error",e.snackbar=!0}));case 3:e.close();case 4:case"end":return t.stop()}}),t)})))()},nextPage:function(){this.page+1<=this.numberOfPages&&(this.page+=1)},formerPage:function(){this.page-1>=1&&(this.page-=1)},updateItemsPerPage:function(e){this.itemsPerPage=e}}},l=n(97),d=n(135),v=n.n(d),m=n(424),f=n(487),h=n(208),_=n(112),k=n(488),x=n(438),y=n(445),I=n(597),P=n(581),w=n(427),V=n(176),$=n(423),D=n(428),C=n(425),j=n(218),O=n(430),S=n(442),R=n(501),T=n(453),J=n(443),B=n(484),A=n(73),L=n(594),component=Object(l.a)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-data-iterator",{attrs:{items:e.items,"items-per-page":e.itemsPerPage,page:e.page,search:e.search,"sort-by":e.sortBy.toLowerCase(),"sort-desc":e.sortDesc,"hide-default-footer":""},on:{"update:itemsPerPage":function(t){e.itemsPerPage=t},"update:items-per-page":function(t){e.itemsPerPage=t},"update:page":function(t){e.page=t}},scopedSlots:e._u([{key:"header",fn:function(){return[n("v-toolbar",{staticClass:"mb-1",attrs:{dark:"",color:"blue darken-3"}},[n("v-text-field",{attrs:{clearable:"",flat:"","solo-inverted":"","hide-details":"","prepend-inner-icon":"mdi-magnify",label:"Search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),e.$vuetify.breakpoint.mdAndUp?[n("v-spacer"),e._v(" "),n("v-select",{attrs:{flat:"","solo-inverted":"","hide-details":"",items:e.keys,"prepend-inner-icon":"mdi-magnify",label:"Sort by"},model:{value:e.sortBy,callback:function(t){e.sortBy=t},expression:"sortBy"}}),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn-toggle",{attrs:{mandatory:""},model:{value:e.sortDesc,callback:function(t){e.sortDesc=t},expression:"sortDesc"}},[n("v-btn",{attrs:{large:"",depressed:"",color:"blue",value:!1}},[n("v-icon",[e._v("mdi-arrow-up")])],1),e._v(" "),n("v-btn",{attrs:{large:"",depressed:"",color:"blue",value:!0}},[n("v-icon",[e._v("mdi-arrow-down")])],1)],1)]:e._e()],2)]},proxy:!0},{key:"default",fn:function(t){return[n("v-row",e._l(t.items,(function(t){return n("v-col",{key:t.name,attrs:{cols:"12",sm:"6",lg:"4"}},[n("v-card",{staticStyle:{height:"100%"},attrs:{extended:""}},[n("v-fab-transition",[n("v-btn",{attrs:{color:"primary",fab:"",small:"",absolute:"",top:"",right:""},on:{click:function(t){return e.deleteItem()}}},[n("v-icon",[e._v("mdi-delete")])],1)],1),e._v(" "),n("v-fab-transition",[n("v-btn",{staticStyle:{transform:"translateX(-150%)"},attrs:{color:"primary",fab:"",small:"",absolute:"",top:"",right:""},on:{click:function(n){return e.editItem(t)}}},[n("v-icon",[e._v("mdi-pencil")])],1)],1),e._v(" "),n("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"text-h5"},[e._v(e._s(e.formTitle))])]),e._v(" "),n("v-card-text",[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("ValidationObserver",{ref:"observer",refInFor:!0},[n("ValidationProvider",{attrs:{name:"name",rules:"required|max:100"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors;return[n("v-text-field",{attrs:{counter:100,"error-messages":r,label:"Ime Posla"},model:{value:e.editedItem.name,callback:function(t){e.$set(e.editedItem,"name",t)},expression:"editedItem.name"}})]}}],null,!0)}),e._v(" "),n("ValidationProvider",{attrs:{name:"Opis posla",rules:"required|max:1000"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors;return[n("v-text-field",{attrs:{counter:1e3,"error-messages":r,label:"Opis posla"},model:{value:e.editedItem.description,callback:function(t){e.$set(e.editedItem,"description",t)},expression:"editedItem.description"}})]}}],null,!0)})],1),e._v(" "),n("v-treeview",{attrs:{items:e.services,selectable:"","selection-type":"fix your god damn documentation","selected-color":"primary",hoverable:"","item-key":"id","open-on-click":""},model:{value:e.editedItem.selection,callback:function(t){e.$set(e.editedItem,"selection",t)},expression:"editedItem.selection"}})],1)],1)],1)],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.close}},[e._v("\n                    Odustani\n                  ")]),e._v(" "),"Uredi posao"===e.formTitle?n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(n){return e.update(t)}}},[e._v("\n                    Spremi\n                  ")]):e._e()],1)],1)],1),e._v(" "),n("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialogDelete,callback:function(t){e.dialogDelete=t},expression:"dialogDelete"}},[n("v-card",[n("v-card-title",{staticClass:"text-h5"},[e._v("Jeste li sigurni da Å¾elite pobrisati ovaj posao?")]),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.closeDelete}},[e._v("Cancel")]),e._v(" "),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(n){return e.deleteJob(t)}}},[e._v("OK")]),e._v(" "),n("v-spacer")],1)],1)],1),e._v(" "),n("v-card-title",{staticClass:"subheading font-weight-bold"},[e._v("\n              "+e._s(t.name)+"\n            ")]),e._v(" "),n("v-divider"),e._v(" "),n("v-card-text",[e._v("\n              "+e._s(t.description)+"\n            ")]),e._v(" "),n("v-card-subtitle",[e._v("\n              "+e._s(t.user.name)+" "),n("br"),e._v("\n              "+e._s(t.user.email)+"\n            ")]),e._v(" "),n("v-card-subtitle",[e._v("\n              "+e._s(t.datum)+"\n            ")]),e._v(" "),n("v-divider"),e._v(" "),n("div",e._l(t.services_names,(function(t){return n("v-chip",{key:t,staticStyle:{margin:"2px"}},[e._v("\n                "+e._s(t)+"\n              ")])})),1)],1)],1)})),1)]}},{key:"footer",fn:function(){return[n("v-row",{staticClass:"mt-2",attrs:{align:"center",justify:"center"}},[n("span",{staticClass:"grey--text"},[e._v("Items per page")]),e._v(" "),n("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,o=t.attrs;return[n("v-btn",e._g(e._b({staticClass:"ml-2",attrs:{dark:"",text:"",color:"primary"}},"v-btn",o,!1),r),[e._v("\n              "+e._s(e.itemsPerPage)+"\n              "),n("v-icon",[e._v("mdi-chevron-down")])],1)]}}])},[e._v(" "),n("v-list",e._l(e.itemsPerPageArray,(function(t,r){return n("v-list-item",{key:r,on:{click:function(n){return e.updateItemsPerPage(t)}}},[n("v-list-item-title",[e._v(e._s(t))])],1)})),1)],1),e._v(" "),n("v-spacer"),e._v(" "),n("span",{staticClass:"mr-4\n          grey--text"},[e._v("\n          Page "+e._s(e.page)+" of "+e._s(e.numberOfPages)+"\n        ")]),e._v(" "),n("v-btn",{staticClass:"mr-1",attrs:{fab:"",dark:"",color:"blue darken-3"},on:{click:e.formerPage}},[n("v-icon",[e._v("mdi-chevron-left")])],1),e._v(" "),n("v-btn",{staticClass:"ml-1",attrs:{fab:"",dark:"",color:"blue darken-3"},on:{click:e.nextPage}},[n("v-icon",[e._v("mdi-chevron-right")])],1)],1)]},proxy:!0}])}),e._v(" "),n("v-snackbar",{attrs:{outlined:"","multi-line":"",color:e.color,timeout:e.timeout,"content-class":"text-center"},model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v("\n    "+e._s(e.message)+"\n  ")])],1)}),[],!1,null,"6c64723e",null);t.default=component.exports;v()(component,{VBtn:m.a,VBtnToggle:f.a,VCard:h.a,VCardActions:_.a,VCardSubtitle:_.b,VCardText:_.c,VCardTitle:_.d,VChip:k.a,VCol:x.a,VContainer:y.a,VDataIterator:I.a,VDialog:P.a,VDivider:w.a,VFabTransition:V.c,VIcon:$.a,VList:D.a,VListItem:C.a,VListItemTitle:j.b,VMenu:O.a,VRow:S.a,VSelect:R.a,VSnackbar:T.a,VSpacer:J.a,VTextField:B.a,VToolbar:A.a,VTreeview:L.a})},588:function(e,t,n){"use strict";n.r(t);var r={name:"my-jobs",middleware:function(e){var t=e.redirect,n=e.$auth,r=n.$state.user.role_id;2===r||1===r||(n.$state.loggedIn?t("/"):t("/login"))}},o=n(97),component=Object(o.a)(r,(function(){var e=this.$createElement;return(this._self._c||e)("my-jobs-menu")}),[],!1,null,"a7bdc61a",null);t.default=component.exports;installComponents(component,{MyJobsMenu:n(495).default})}}]);